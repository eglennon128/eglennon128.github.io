(()=>{var W={drone:"content/portfolio-drone.json",gis:"content/portfolio-gis.json"};function Y(c){let u=document.createElement("article");u.className="group portfolio-card",u.dataset.type=c.type||"misc",u.dataset.itemId=c.id||"";let b=document.createElement("div");b.className="card-media";let m=document.createElement("img");m.src=c.image,m.alt=c.alt||"",m.loading="lazy",m.decoding="async",b.appendChild(m);let L=document.createElement("div");L.className="card-body";let v=document.createElement("h3");v.className="card-title",v.textContent=c.title;let I=document.createElement("p");if(I.className="card-desc",I.textContent=c.description||"",L.appendChild(v),L.appendChild(I),c.cta&&c.cta.href&&c.cta.label){let A=document.createElement("a");A.className="inline-flex items-center gap-1 text-blue-700 hover:text-blue-800 link-underline mt-4",A.href=c.cta.href,A.textContent=c.cta.label;let p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.setAttribute("stroke","currentColor"),p.setAttribute("stroke-width","2"),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.classList.add("h-5","w-5","transition-transform","group-hover:translate-x-0.5");let D=document.createElementNS("http://www.w3.org/2000/svg","path");D.setAttribute("d","M9 18l6-6-6-6"),p.appendChild(D),A.appendChild(p),L.appendChild(A)}return u.appendChild(b),u.appendChild(L),u}async function $(c,u){let b=document.querySelector(c);if(!b)return;let m=b.querySelector("[data-dynamic-list]");if(!m&&b.matches("[data-dynamic-list]")&&(m=b),!!m)try{let L=await fetch(W[u]);if(!L.ok)throw new Error(`Failed to load ${u} data`);let v=await L.json(),I=new Set(Array.from(m.querySelectorAll("[data-item-id]")).map(A=>A.dataset.itemId));v.forEach(A=>{if(I.has(A.id))return;let p=Y(A);p.dataset.stacked="dynamic",m.appendChild(p)})}catch(L){console.warn("Portfolio data failed to load",L);let v=document.createElement("div");v.className="mt-4 text-sm text-red-600",v.textContent="Additional projects will appear here once the site is fully loaded. Please try again later.",m.appendChild(v)}}function R(){$("#drone-portfolio-grid","drone"),$("#gis-portfolio-grid","gis")}(function(){"use strict";let c=document.getElementById("menuButton"),u=document.getElementById("mobileMenu"),b=document.querySelector("#menuButton .icon-burger"),m=document.querySelector("#menuButton .icon-close");function L(){u.hidden=!1,requestAnimationFrame(()=>{u.classList.add("open")}),c.setAttribute("aria-expanded","true"),b&&m&&(b.classList.add("hidden"),m.classList.remove("hidden"))}function v(){u.classList.remove("open");let t=n=>{n.propertyName==="max-height"&&(u.hidden=!0,u.removeEventListener("transitionend",t))};u.addEventListener("transitionend",t),c.setAttribute("aria-expanded","false"),b&&m&&(b.classList.remove("hidden"),m.classList.add("hidden"))}function I(){c.getAttribute("aria-expanded")==="true"?v():L()}c&&u&&(c.addEventListener("click",I),document.addEventListener("keydown",t=>{t.key==="Escape"&&c.getAttribute("aria-expanded")==="true"&&v()}),document.addEventListener("click",t=>{if(!(c.getAttribute("aria-expanded")==="true"))return;let o=t.target;c.contains(o)||u.contains(o)||v()}),u.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{c.getAttribute("aria-expanded")==="true"&&v()})}));let A=document.getElementById("year");A&&(A.textContent=new Date().getFullYear());let p=Array.from(document.querySelectorAll(".reveal"));if((function(){let n=new Set;p.forEach(o=>{o.parentElement&&n.add(o.parentElement)}),n.forEach(o=>{let i=o.getAttribute&&o.getAttribute("data-stagger-step"),l=o.getAttribute&&o.getAttribute("data-stagger-base"),S=parseInt(i||"80",10),q=parseInt(l||"0",10);Array.from(o.querySelectorAll(":scope > .reveal, :scope > * .reveal")).filter(Boolean).forEach((h,g)=>{h.style.transitionDelay||(h.style.transitionDelay=`${q+g*S}ms`),h.classList.add("will-fade")})})})(),"IntersectionObserver"in window&&p.length){let t=new IntersectionObserver((n,o)=>{n.forEach(i=>{i.isIntersecting&&(i.target.classList.add("in-view"),o.unobserve(i.target))})},{threshold:.15,rootMargin:"0px 0px -4% 0px"});p.forEach(n=>t.observe(n))}else p.forEach(t=>t.classList.add("in-view"));let D=Array.from(document.querySelectorAll(".accordion-trigger"));function z(t,n){n.hidden=!1,n.classList.add("open"),n.style.maxHeight=n.scrollHeight+"px",t.setAttribute("aria-expanded","true")}function G(t,n){n.style.maxHeight=n.scrollHeight+"px",n.offsetHeight,n.style.maxHeight="0px",n.classList.remove("open");let o=i=>{i.propertyName==="max-height"&&(n.hidden=!0,n.removeEventListener("transitionend",o))};n.addEventListener("transitionend",o),t.setAttribute("aria-expanded","false")}D.forEach(t=>{let n=t.getAttribute("aria-controls"),o=document.getElementById(n);o&&(t.setAttribute("aria-expanded",o.classList.contains("open")?"true":"false"),t.addEventListener("click",()=>{t.getAttribute("aria-expanded")==="true"?G(t,o):z(t,o)}))}),window.addEventListener("resize",()=>{document.querySelectorAll(".accordion-panel.open").forEach(t=>{t.style.maxHeight=t.scrollHeight+"px"})});let B=document.getElementById("contactForm");if(B){let h=function(e,r){e.classList.add("error");let f=e.closest("div").querySelector(".error-msg");f&&(f.textContent=r||"")},g=function(e){e.classList.remove("error");let r=e.closest("div").querySelector(".error-msg");r&&(r.textContent="")},d=function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},t=B.querySelector("#name"),n=B.querySelector("#email"),o=B.querySelector("#service"),i=B.querySelector("#message"),l=document.getElementById("formStatus"),q=(new URLSearchParams(window.location.search).get("service")||"").toLowerCase();q&&new Set(["drone-media","gis-mapping","other"]).has(q)&&(o.value=q),[t,n,o,i].forEach(e=>{e.addEventListener("blur",()=>{e===t&&!e.value.trim()?h(e,"Please enter your name."):e===t&&g(e),e===n&&!d(e.value.trim())?h(e,"Enter a valid email address."):e===n&&g(e),e===o&&!e.value?h(e,"Please choose a service."):e===o&&g(e),e===i&&!e.value.trim()?h(e,"Please tell me about your project."):e===i&&g(e)})}),B.addEventListener("submit",e=>{let r=!0;if(t.value.trim()?g(t):(h(t,"Please enter your name."),r=!1),d(n.value.trim())?g(n):(h(n,"Enter a valid email address."),r=!1),o.value?g(o):(h(o,"Please choose a service."),r=!1),i.value.trim()?g(i):(h(i,"Please tell me about your project."),r=!1),!r){e.preventDefault(),l&&(l.textContent="Please fix the highlighted fields.",l.style.color="#dc2626");return}l&&(l.textContent="Sending\u2026",l.style.color="#4b5563")})}if((function(){Array.from(document.querySelectorAll('a[href^="#"]')).forEach(o=>{o.addEventListener("click",i=>{let l=o.getAttribute("href");if(l==="#"||l.length<2)return;let S=document.querySelector(l);S&&(i.preventDefault(),S.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,"",l))})})})(),document.querySelector(".js-tabs")){let S=function(d){let e=i[d];if(!e)return;let r=`#${e}`;window.location.hash!==r&&(l=!0,history.replaceState(null,"",r),window.requestAnimationFrame(()=>{l=!1}))},q=function(d,e={}){let{skipHashUpdate:r=!1}=e;t.forEach(w=>{w.classList.remove("is-active"),w.setAttribute("aria-selected","false")}),n.forEach(w=>w.classList.remove("is-active"));let f=t.find(w=>w.getAttribute("data-tab-target")===d),P=document.getElementById(d);f&&(f.classList.add("is-active"),f.setAttribute("aria-selected","true")),P&&P.classList.add("is-active"),r||S(d)},H=function({scroll:d=!0}={}){let e=window.location.hash.replace("#","").toLowerCase(),r=o[e];if(!r)return!1;if(q(r,{skipHashUpdate:!0}),d){let f=document.getElementById(e);f&&f.scrollIntoView({behavior:"smooth",block:"start"})}return!0},g=function(d,e){let r=document.getElementById(d),f=document.getElementById(e);if(!r||!f)return;let P=Array.from(f.querySelectorAll(".portfolio-card"));r.addEventListener("change",()=>{let w=r.value;P.forEach(x=>{let F=(x.getAttribute("data-type")||"").toLowerCase();if(w==="all"||w===F)x.style.display="",requestAnimationFrame(()=>{x.classList.remove("hidden-by-filter"),x.removeAttribute("aria-hidden")});else if(!x.classList.contains("hidden-by-filter")){x.classList.add("hidden-by-filter");let O=N=>{N.propertyName==="opacity"&&(x.style.display="none",x.setAttribute("aria-hidden","true"),x.removeEventListener("transitionend",O))};x.addEventListener("transitionend",O)}})})},t=Array.from(document.querySelectorAll(".tab-btn")),n=Array.from(document.querySelectorAll("[data-tab-panel]")),o={drone:"tab-drone",gis:"tab-gis"},i=Object.fromEntries(Object.entries(o).map(([d,e])=>[e,d])),l=!1;if(t.forEach(d=>{d.addEventListener("click",e=>{let r=d.getAttribute("data-tab-target");if(!r)return;document.getElementById(r)&&(e.preventDefault(),q(r))})}),!H({scroll:!1})){let d=t.find(e=>e.classList.contains("is-active"));d&&q(d.getAttribute("data-tab-target"),{skipHashUpdate:!0})}window.addEventListener("hashchange",()=>{l||H()}),g("droneFilter","tab-drone"),g("gisFilter","tab-gis")}R(),(function(){let n=document.querySelector('[data-filter-scope="drone"]'),o=document.getElementById("droneGrid");if(n&&o){let k=function(y){s.forEach(E=>E.classList.remove("is-active")),y.classList.add("is-active")},C=function(y){a.forEach(E=>{let M=(E.getAttribute("data-type")||"").toLowerCase();if(y==="all"||y===M)E.style.display="",requestAnimationFrame(()=>{E.classList.remove("hidden-by-filter"),E.removeAttribute("aria-hidden")});else if(!E.classList.contains("hidden-by-filter")){E.classList.add("hidden-by-filter");let V=K=>{K.propertyName==="opacity"&&(E.style.display="none",E.setAttribute("aria-hidden","true"),E.removeEventListener("transitionend",V))};E.addEventListener("transitionend",V)}})},s=Array.from(n.querySelectorAll("[data-filter]")),a=Array.from(o.querySelectorAll(".media-card"));s.forEach(y=>{y.addEventListener("click",()=>{k(y),C(y.getAttribute("data-filter"))})})}let i=document.getElementById("lightbox");if(!i)return;let l=i.querySelector(".lightbox-dialog"),S=document.getElementById("lightboxMedia"),q=document.getElementById("lightboxTitle"),H=document.getElementById("lightboxDesc"),h=i.querySelector("[data-prev]"),g=i.querySelector("[data-next]"),d=i.querySelectorAll("[data-close]"),e=[],r=0,f=null,P='a[href], area[href], button:not([disabled]), input:not([disabled]):not([type="hidden"]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';function w(s){if(s.key!=="Tab")return;let a=Array.from(l.querySelectorAll(P)).filter(y=>y.offsetParent!==null||y===document.activeElement);if(!a.length){s.preventDefault(),l.focus();return}let k=a[0],C=a[a.length-1];s.shiftKey?document.activeElement===k&&(s.preventDefault(),C.focus()):document.activeElement===C&&(s.preventDefault(),k.focus())}function x(s){return/\.(mp4|webm|ogg)(\?|$)/i.test(s)}function F(s){if(S.innerHTML="",x(s)){let a=document.createElement("video");a.src=s,a.controls=!0,a.autoplay=!0,a.playsInline=!0,a.setAttribute("preload","metadata"),S.appendChild(a)}else{let a=document.createElement("img");a.src=s,a.loading="lazy",a.decoding="async",S.appendChild(a)}}function T(){let s=e.length>1;h.style.display=s?"":"none",g.style.display=s?"":"none"}function O(s,a,k,C){e=s,r=a||0,q.textContent=k||"",H.textContent=C||"",F(e[r]),T(),f=document.activeElement,i.hidden=!1,i.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>{i.classList.add("open");let y=l.querySelector("[data-close]")||l;l.setAttribute("tabindex","-1"),y.focus()}),i.addEventListener("keydown",w),document.documentElement.style.overflow="hidden"}function N(){i.classList.remove("open"),i.setAttribute("aria-hidden","true");let s=a=>{a.propertyName==="opacity"&&(i.hidden=!0,i.removeEventListener("transitionend",s))};i.addEventListener("transitionend",s),i.removeEventListener("keydown",w),document.documentElement.style.overflow="",f&&typeof f.focus=="function"&&f.focus(),f=null}function j(){e.length&&(r=(r+1)%e.length,F(e[r]))}function U(){e.length&&(r=(r-1+e.length)%e.length,F(e[r]))}document.querySelectorAll("[data-lightbox]").forEach(s=>{s.addEventListener("click",a=>{a.preventDefault();let k=(s.getAttribute("data-gallery")||"").trim();if(!k)return;let C=k.split("|").map(M=>M.trim()).filter(Boolean),y=s.getAttribute("data-title")||"",E=s.getAttribute("data-desc")||"";O(C,0,y,E)})}),g&&g.addEventListener("click",j),h&&h.addEventListener("click",U),d.forEach(s=>s.addEventListener("click",N)),i.addEventListener("click",s=>{s.target.hasAttribute("data-close")&&N()}),document.addEventListener("keydown",s=>{i.hidden||(s.key==="Escape"&&N(),s.key==="ArrowRight"&&j(),s.key==="ArrowLeft"&&U())})})()})();})();
